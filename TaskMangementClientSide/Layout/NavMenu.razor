@using Microsoft.AspNetCore.Components.Authorization
@inject AuthenticationStateProvider AuthStateProvider


<div class="nav-menu-container">
    <!-- Brand Header -->
    <div class="nav-brand-header text-center py-4">
        <div class="my-3">
            <img src="images/TaskMa.png" alt="Logo" width="120" height="120"
                 class="rounded-circle border border-2 border-primary shadow-sm" />
        </div>
        <h4 class="brand-text mb-0">Taskma</h4>
    </div>

    <!-- Navigation Links - Moved upward -->
    <nav class="nav flex-column nav-links-container">
        <!-- Dashboard -->
        <div class="nav-item px-3">
            <NavLink class="nav-link d-flex align-items-center gap-3" href="@dashboardUrl">
                <i class="bi bi-speedometer2 fs-5 text-dark" style="min-width: 24px;"></i>
                <span class="flex-grow-1">Dashboard</span>
            </NavLink>
        </div>

        
        <div class="nav-item px-3">
            <NavLink class="nav-link d-flex align-items-center gap-3" href="@sprintUrl" >
                <i class="bi bi-kanban-fill fs-5 text-success" style="min-width: 24px;"></i>
                <span class="flex-grow-1">Sprints</span>
            </NavLink>
        </div>
        
       
        <!-- Members -->
        @if (isManager || isAdmin)
        {
            <div class="nav-item px-3">
                <NavLink class="nav-link d-flex align-items-center gap-3" href="@memberUrl">
                    <i class="bi bi-people-fill fs-5 text-info" style="min-width: 24px;"></i>
                    <span class="flex-grow-1">Members</span>
                </NavLink>
            </div>
        }
        @if (isAdmin)
        {
            <div class="nav-item px-3">
                <NavLink class="nav-link d-flex align-items-center gap-3" href="managerslist">
                    <i class="bi bi-person-badge-fill fs-5 text-info" style="min-width: 24px;"></i>
                    <span class="flex-grow-1">Managers</span>
                </NavLink>
            </div>
        }

    </nav>
</div>

@code {
    bool isAdmin=false;
    bool isManager = false;
    bool isMember = false;
    string dashboardUrl = "";
    string sprintUrl = "";
    string memberUrl = "";
    protected override async Task OnInitializedAsync()
    {
        var authState = await AuthStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;

        isAdmin = user.IsInRole("Admin");
        isManager = user.IsInRole("Manager");
        isMember = user.IsInRole("Member");

        if(isAdmin)
        {
            dashboardUrl = "/dashboard";
            sprintUrl = "/adminsprints";
            memberUrl = "/members";

        }
        else if(isManager)
        {
            dashboardUrl = "/managerdashboard";
            sprintUrl = "/managersprints";
           
            memberUrl = "/managereditmembers";
        }
       else
       {
            dashboardUrl = "/memberDashboard";
            sprintUrl = "/membersprints";
            memberUrl = "";
        }
    


    }

}